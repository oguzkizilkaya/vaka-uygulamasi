<!DOCTYPE html>
<html lang="tr">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pediatrik Vaka: aHÃœS YÃ¶netimi</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c 0%, #b21f1f 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        .container {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            max-width: 900px;
            width: 100%;
            padding: 40px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 600px; /* Footer'Ä±n aÅŸaÄŸÄ±da durmasÄ± iÃ§in min yÃ¼kseklik */
        }

        .screen { display: none; opacity: 0; transition: opacity 0.5s ease; flex-grow: 1; }
        .screen.active { display: block; opacity: 1; animation: slideUp 0.6s ease-out; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 { color: #b21f1f; margin-bottom: 20px; font-size: 26px; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
        
        .case-header {
            background: #f1f3f5;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 5px solid #1a2a6c;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
        }
        .status-stable { background: #28a745; }
        .status-critical { background: #dc3545; }
        .status-chronic { background: #ffc107; color: #333; }

        .lab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
            background: #fff;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 5px;
        }
        .lab-item { font-size: 14px; }
        .lab-val { font-weight: bold; color: #b21f1f; }

        .question { font-size: 19px; font-weight: 600; margin-bottom: 25px; color: #2c3e50; }

        .options { display: flex; flex-direction: column; gap: 15px; }
        
        .option-btn {
            background: white;
            border: 2px solid #e9ecef;
            padding: 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        
        .option-btn:hover { border-color: #1a2a6c; background: #f8f9fa; transform: translateX(5px); }
        .option-btn::before {
            content: '';
            position: absolute;
            left: 0; top: 0; height: 100%; width: 5px;
            background: #1a2a6c;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .option-btn:hover::before { opacity: 1; }

        .outcome-screen { text-align: center; padding: 20px; }
        .outcome-icon { font-size: 60px; margin-bottom: 20px; display: block; }
        .outcome-title { font-size: 24px; font-weight: bold; margin-bottom: 15px; }
        .outcome-desc { font-size: 16px; line-height: 1.6; color: #555; margin-bottom: 30px; }
        
        .outcome-good { color: #28a745; }
        .outcome-moderate { color: #fd7e14; }
        .outcome-bad { color: #dc3545; }

        /* Referans Kutusu Stili */
        .ref-citation {
            background-color: #f8f9fa;
            border-left: 4px solid #1a2a6c;
            padding: 12px;
            margin-top: 20px;
            margin-bottom: 20px;
            text-align: left;
            font-size: 13px;
            color: #555;
            border-radius: 0 5px 5px 0;
            line-height: 1.4;
        }

        .ref-citation strong {
            color: #b21f1f;
            display: block;
            margin-bottom: 4px;
            font-size: 14px;
        }

        .ref-citation em {
            display: block;
            margin-top: 6px;
            font-size: 11px;
            color: #888;
            text-align: right;
        }

        .restart-btn {
            background: #1a2a6c; color: white; border: none;
            padding: 15px 40px; border-radius: 8px; font-size: 16px;
            cursor: pointer; transition: background 0.3s;
        }
        .restart-btn:hover { background: #2c3e50; }

        .admin-btn {
            position: fixed; bottom: 20px; right: 20px;
            background: #343a40; color: white; border: none;
            padding: 12px 25px; border-radius: 50px;
            cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 100;
            transition: transform 0.2s;
            text-decoration: none;
            font-size: 14px;
        }
        .admin-btn:hover { transform: scale(1.05); background: #23272b; }

        /* --- YENÄ° EKLENEN FOOTER STÄ°LLERÄ° --- */
        .footer-row {
            margin-top: auto; /* Ä°Ã§eriÄŸin en altÄ±na iter */
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .footer-links {
            font-size: 11px;
            color: #666;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .footer-links a {
            color: #1a2a6c;
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer-links a:hover {
            text-decoration: underline;
        }

        .footer-logo img {
            height: 40px; /* Logonun yÃ¼ksekliÄŸi, duruma gÃ¶re 30px-50px arasÄ± ayarlanabilir */
            width: auto;
            display: block;
        }
        
        @media (max-width: 600px) {
            .footer-row {
                flex-direction: column-reverse;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        
        <div class="screen active" id="scene1">
            <h1>Vaka Sunumu</h1>
            <span class="status-badge status-stable">Pediatrik Acil BaÅŸvurusu</span>
            
            <div class="case-header">
                <h3>4 YaÅŸÄ±nda Erkek Hasta</h3>
                <p>Annesi tarafÄ±ndan "solukluk, huzursuzluk ve son 24 saattir idrar Ã§Ä±kÄ±ÅŸÄ± olmamasÄ±" ÅŸikayetiyle getirildi. Ã–ykÃ¼de 1 hafta Ã¶nce ateÅŸli Ã¼st solunum yolu enfeksiyonu var. <strong>KanlÄ± ishal Ã¶ykÃ¼sÃ¼ yok.</strong></p>
            </div>

            <div class="lab-grid">
                <div class="lab-item">Hb: <span class="lab-val">7.2 g/dL</span> </div>
                <div class="lab-item">Plt: <span class="lab-val">45.000/mmÂ³</span> </div>
                <div class="lab-item">Kreatinin: <span class="lab-val">1.9 mg/dL</span> (YaÅŸa gÃ¶re ABY)</div>
                <div class="lab-item">LDH: <span class="lab-val">1800 U/L</span> </div>
                <div class="lab-item">Periferik Yayma: <span class="lab-val">Åistosit (+)</span></div>
            </div>

            <p class="question"> Mevcut bulgular ile hastaya ilk yaklaÅŸÄ±mÄ±nÄ±z nasÄ±l olur?</p>

            <div class="options">
                <button class="option-btn" onclick="makeDecision(1, 'A')">
                    <strong>A)</strong> STEC-HÃœS ve aHÃœS ayrÄ±mÄ± iÃ§in tetkik (Gaita kÃ¼ltÃ¼rÃ¼, ADAMTS13) isterim, hidrasyona baÅŸlarÄ±m.
                </button>
                <button class="option-btn" onclick="makeDecision(1, 'B')">
                    <strong>B)</strong> Viral enfeksiyon sonrasÄ± geÃ§ici bir tablodur, destek tedavisi ve antibiyotik ile izlerim.
                </button>
            </div>
        </div>

        <div class="screen" id="scene2a">
            <h1>TanÄ±sal DeÄŸerlendirme</h1>
            <span class="status-badge status-stable">SonuÃ§lar Ã‡Ä±ktÄ±</span>
            
            <div class="case-header">
                <h3>Kritik AyrÄ±m</h3>
                <p>Gaita kÃ¼ltÃ¼rÃ¼: <strong>Negatif</strong> <br>
                ADAMTS13 aktivitesi: <strong>%70 (Normal)</strong> <br>
                Hasta halen anÃ¼rik. Kreatinin 2.4 mg/dL'ye yÃ¼kseldi ve yaÅŸa gÃ¶re hipertansif (130/90 mmHg).</p>
            </div>

            <p class="question"> Bu hasta iÃ§in tedavi planÄ±nÄ±z nasÄ±l olur?</p>

            <div class="options">
                <button class="option-btn" onclick="makeDecision(2, 'A')">
                    <strong>A)</strong> Santral kateterizasyon ile plazma deÄŸiÅŸimi baÅŸlayalÄ±m, yanÄ±t alamazsak ilaÃ§ dÃ¼ÅŸÃ¼nelim.
                </button>
                <button class="option-btn" onclick="makeDecision(2, 'B')">
                    <strong>B)</strong> Eculizumab baÅŸla + Meningokok aÅŸÄ±sÄ± ve profilaksisi yap.
                </button>
            </div>
            <div style="font-size:12px; color:#666; margin-top:10px;">*Not: TPE Ã§ocuklarda teknik zorluklar iÃ§erir ve aHÃœS'te etkinliÄŸi sÄ±nÄ±rlÄ±dÄ±r.</div>
        </div>

        <div class="screen" id="scene2b">
            <h1>Klinik KÃ¶tÃ¼leÅŸme</h1>
            <span class="status-badge status-critical">Durum: Kritik</span>
            
            <div class="case-header">
                <h3>12 Saat Sonra</h3>
                <p>Hasta nÃ¶bet geÃ§irdi (aHÃœS santral tutulumu ?).<br>
                <strong>Yeni Lab:</strong> Hb: 6.0 g/dL, Plt: 20.000, <strong>Kreatinin: 3.5 mg/dL</strong>.<br>
                Destek tedavisi yetersiz kaldÄ±. Ã‡oklu organ yetmezliÄŸi riski var.</p>
            </div>

            <p class="question"> HastanÄ±n kliniÄŸi kÃ¶tÃ¼leÅŸiyor, kararÄ±nÄ±z ne yÃ¶nde olur? </p>

            <div class="options">
                <button class="option-btn" onclick="makeDecision(2, 'C')">
                    <strong>A)</strong> Acil Diyaliz + Eculizumab tedavisi
                </button>
                <button class="option-btn" onclick="makeDecision(2, 'D')">
                    <strong>B)</strong> Sadece Diyaliz ve Taze DonmuÅŸ Plazma infÃ¼zyonu.
                </button>
            </div>
        </div>

        <div class="screen" id="scene3_dialysis">
            <h1>1 YÄ±l Sonra...</h1>
            <span class="status-badge status-chronic">Durum: Son DÃ¶nem BÃ¶brek YetmezliÄŸi (SDBY)</span>
            
            <div class="case-header">
                <h3>Poliklinik KontrolÃ¼</h3>
                <p>Hasta periton diyalizi ile takip ediliyor. BÃ¼yÃ¼me-geliÅŸme geriliÄŸi baÅŸladÄ±.<br>
                Annesinden canlÄ± bÃ¶brek nakli planlanÄ±yor.</p>
            </div>

            <p class="question">aHÃœS tanÄ±lÄ± Ã§ocuk hastada nakil (transplantasyon) stratejiniz ne olmalÄ±?</p>

            <div class="options">
                <button class="option-btn" onclick="makeDecision(3, 'A')">
                    <strong>A)</strong> Nakil Ã¶ncesi profilaktik Eculizumab baÅŸla, sonra nakil yap.
                </button>
                <button class="option-btn" onclick="makeDecision(3, 'B')">
                    <strong>B)</strong> Sadece nakil yapÄ±p nÃ¼ks gÃ¶zlenirse Eculizumab tedavisi baÅŸlayalÄ±m.
                </button>
            </div>
        </div>

        <div class="screen outcome-screen" id="outcome_perfect">
            <span class="outcome-icon outcome-good">ğŸŒŸ</span>
            <h2 class="outcome-title outcome-good">Tam Ä°yileÅŸme (Renal Recovery)</h2>
            <p class="outcome-desc">
                HÄ±zlÄ± Eculizumab tedavisi (ilk 24-48 saat) sayesinde bÃ¶brek fonksiyonlarÄ± tamamen normale dÃ¶ndÃ¼<br>
                Diyaliz ihtiyacÄ± kalmadÄ±. Ã‡ocuk normal geliÅŸimine devam ediyor.<br>
                Genetik panelde <em>CFH</em> mutasyonu saptandÄ±.
            </p>
            <div class="ref-citation">
                <strong>ğŸ“š KanÄ±t Temelli YaklaÅŸÄ±m:</strong>
                Ã‡ocuklarda aHÃœS tanÄ±sÄ± konulur konulmaz Eculizumab birinci basamak (first-line) tedavi olmalÄ±dÄ±r. Plazma tedavisi teknik zorluklar ve dÃ¼ÅŸÃ¼k etkinlik nedeniyle Ã¶nerilmez.
                <em>â€” Loirat C, et al. Pediatric Nephrology. 2016</em>
            </div>
            <button class="restart-btn" onclick="resetCase()">VakayÄ± Tekrar BaÅŸlat</button>
        </div>

        <div class="screen outcome-screen" id="outcome_ckd">
            <span class="outcome-icon outcome-moderate">âš ï¸</span>
            <h2 class="outcome-title outcome-moderate">KalÄ±cÄ± BÃ¶brek HasarÄ±</h2>
            <p class="outcome-desc">
                TanÄ±daki gecikme ve yetersiz tedavi (sadece plazma) nedeniyle kortikal nekroz geliÅŸti.<br>
                Hematolojik deÄŸerler dÃ¼zeldi ancak GFR 40 ml/dk civarÄ±nda kaldÄ±. Ä°leride nakil adayÄ±.
            </p>
            <div class="ref-citation">
                <strong>ğŸ“š Kritik UyarÄ±:</strong>
                Ã–zellikle pediyatrik hastalarda STEC dÄ±ÅŸlandÄ±ÄŸÄ± ve ADAMTS13 normal saptandÄ±ÄŸÄ± anda zaman kaybetmeden anti-kompleman tedavisine baÅŸlanmasÄ± bÃ¶brek fonksiyon kazanÄ±mÄ± iÃ§in kritiktir.
                <em>â€” KDIGO 2017 Clinical Practice Guideline Update (TMA focus)</em>
            </div>
            <button class="restart-btn" onclick="resetCase()">VakayÄ± Tekrar BaÅŸlat</button>
        </div>

        <div class="screen outcome-screen" id="outcome_transplant_success">
            <span class="outcome-icon outcome-good">âœ…</span>
            <h2 class="outcome-title outcome-good">BaÅŸarÄ±lÄ± Pediatrik Nakil</h2>
            <p class="outcome-desc">
                Profilaktik Eculizumab kullanÄ±mÄ± sayesinde greftte fonksiyonlarÄ± korundu.<br>
                Hasta diyaliz baÄŸÄ±msÄ±z takip ediliyor ve bÃ¼yÃ¼me eÄŸrisi normal izleniyor
            </p>
            <div class="ref-citation">
                <strong>ğŸ“š Transplantasyon Verisi:</strong>
                BÃ¶brek nakli Ã¶ncesi genetik riski yÃ¼ksek hastalarda profilaktik Eculizumab kullanÄ±mÄ± greft kaybÄ±nÄ± dramatik ÅŸekilde dÃ¼ÅŸÃ¼rÃ¼rken (%10), profilaksi uygulanmamasÄ± ile nÃ¼ks oranÄ± %80'e varabilmektedir.
                <em>â€” Zuber J, et al. Nature Reviews Nephrology. 2012</em>
            </div>
            <button class="restart-btn" onclick="resetCase()">VakayÄ± Tekrar BaÅŸlat</button>
        </div>

        <div class="screen outcome-screen" id="outcome_transplant_fail">
            <span class="outcome-icon outcome-bad">âŒ</span>
            <h2 class="outcome-title outcome-bad">Greft KaybÄ± ve NÃ¼ks</h2>
            <p class="outcome-desc">
                Nakil sÄ±rasÄ±nda profilaksi yapÄ±lmadÄ±ÄŸÄ± iÃ§in cerrahi stres kompleman sistemini aktive etti.<br>
                Nakilden sonrasÄ± aHÃœS nÃ¼ksÃ¼ ile greft fonksiyonu kaybedildi.
            </p>
            <div class="ref-citation">
                <strong>ğŸ“š Neden BaÅŸarÄ±sÄ±z Oldu?</strong>
                LiteratÃ¼r, profilaktik Eculizumab kullanÄ±lmayan yÃ¼ksek riskli hastalarda nÃ¼ks ve greft kaybÄ± riskinin %80 civarÄ±nda olduÄŸunu gÃ¶stermektedir.
                <em>â€” Zuber J, et al. Nature Reviews Nephrology. 2012</em>
            </div>
            <button class="restart-btn" onclick="resetCase()">VakayÄ± Tekrar BaÅŸlat</button>
        </div>

        <div class="footer-row">
            <div class="footer-links">
                <a href="https://az.box.com/shared/static/knwd88xwnh6vay5ozkj4xo035tpd75od.pdf" target="_blank">â–¼Soliris KÃœB Ã¶zeti iÃ§in tÄ±klayÄ±nÄ±z</a>
                <span>M/TR/UNB-a/0174</span>
            </div>
            <div class="footer-logo">
                <img src="https://az.box.com/shared/static/qzc32ve2j3vdjf1aa7qfvoffsovdxc3k" alt="Logo">
            </div>
        </div>
        </div>

    <button class="admin-btn" onclick="window.location.href='admin.html'">ğŸ“Š Vaka Analizi (Admin)</button>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDQqQ5yd4o07A8Is2Z5UWGnGXuGOcDCCho",
            authDomain: "medicom-ai.firebaseapp.com",
            projectId: "medicom-ai",
            storageBucket: "medicom-ai.firebasestorage.app",
            messagingSenderId: "330987426994",
            appId: "1:330987426994:web:587bc3e397ec376e5565ab"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let currentSession = {
            id: 'user_' + Math.random().toString(36).substr(2, 9),
            startTime: new Date().toISOString(),
            path: [],
            outcome: ''
        };

        window.makeDecision = function(step, choice) {
            currentSession.path.push(`Step${step}:${choice}`);
            const isScene2aActive = document.getElementById('scene2a').classList.contains('active');
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));

            if (step === 1) {
                if (choice === 'A') document.getElementById('scene2a').classList.add('active');
                else document.getElementById('scene2b').classList.add('active');
            }
            else if (step === 2) {
                if (isScene2aActive || currentSession.path.includes('Step1:A')) {
                    if (choice === 'B') finishCase('MÃ¼kemmel Ä°yileÅŸme (Tam Renal Recovery)', 'outcome_perfect');
                    else document.getElementById('scene3_dialysis').classList.add('active');
                } else {
                    if (choice === 'C') finishCase('KalÄ±cÄ± HasarlÄ± Ä°yileÅŸme (KBY)', 'outcome_ckd');
                    else document.getElementById('scene3_dialysis').classList.add('active');
                }
            }
            else if (step === 3) {
                if (choice === 'A') finishCase('BaÅŸarÄ±lÄ± Nakil', 'outcome_transplant_success');
                else finishCase('Greft Rejeksiyonu', 'outcome_transplant_fail');
            }
        };

        async function finishCase(outcomeName, screenId) {
            currentSession.outcome = outcomeName;
            currentSession.endTime = new Date().toISOString(); 
            
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');

            try {
                await addDoc(collection(db, "vaka_kayitlari"), {
                    ...currentSession,
                    createdAt: Timestamp.now()
                });
                console.log("KayÄ±t Firebase'e gÃ¶nderildi.");
            } catch (error) {
                console.error("Firebase HatasÄ±:", error);
            }
        }

        window.resetCase = function() {
            currentSession = {
                id: 'user_' + Math.random().toString(36).substr(2, 9),
                startTime: new Date().toISOString(),
                path: [],
                outcome: ''
            };
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('scene1').classList.add('active');
        };
    </script>
</body>
</html>
